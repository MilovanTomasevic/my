<!DOCTYPE html>
<html>
  <head>
    <title>[High-performance computing (HPC)](/courses/#table-of-contents)</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../remarkslides.css">
    


    <!-- MathJaxâ„¢ -->
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async>
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-127734928-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-127734928-1');
    </script>


    <!-- google analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-127734928-1', 'auto');
      ga('send', 'pageview');
    </script>
  </head>
  <body>
    <textarea id="source">

class: center, middle

## [High-performance computing (HPC)](/courses/#table-of-contents)
### Uvod


.author[[dr. Milovan TomaÅ¡eviÄ‡](https://www.milovantomasevic.com/resume/)]

.small[.medium[[Fakulteta za informacijske Å¡tudije v Novem mestu (FIÅ )](https://www.fis.unm.si/en/)]</br>![:scale 10%](../fis/fis.png) .medium[ [wwww: milovan.tomasevic.fis.unm.si](http://milovan.tomasevic.fis.unm.si)</br> [mail: milovan.tomasevic@fis.unm.si](mailto:milovan.tomasevic@fis.unm.si)]]



.created[18.02.2019 u 02:06]


---


name: sadrzaj

# SadrÅ¾aj

- [O predmetu](#opredmetu)
- [Problem performansi](#problemperformansi)
- [HPC uvod](#hpcuvod)
- [Kratka istorija](#kratkaistorija)


---
name: opredmetu 
class: center, middle

# O predmetu
### motivacija i organizacija

---
layout: true

.section[[O predmetu](#sadrzaj)]

---

## PredavaÄ
            
- [Milovan TomaÅ¡eviÄ‡](/resume/)
- Termin konsultacija je uvek su dostupan kroz poseban dogovor.
- Poseban dogovor kroz javljanje elektronskom posÌŒtom je uvek, uvek preporucÌŒeni metod za konsultacije.
- Dogovor je basÌŒ toâ€”dogovor. 
- Ne mogu da vam obecÌam bilo koji termin, ali mogu da vam obecÌam da cÌu vam izacÌi u susret ako ikako mogu.
  

            
---

## Kako me kontaktirati?
            
- [milovan.tomasevic@fis.unm.si](mailto:milovan.tomasevic@fis.unm.si)
- [milovan.tomasevic.fis.unm.si](milovan.tomasevic.fis.unm.si)
- DesÌŒava se da me stigne poplava elektronske posÌŒte, te stoga ne odgovaram onoliko brzo koliko bi voleo.
- JosÌŒ cÌŒesÌŒcÌe se desÌŒava da nesÌŒto izmeÄ‘u vas i mene pojede poruku elektronske posÌŒte.
- Stoga:
  - Ako brinete da nisam procÌŒitao, posÌŒaljite opet.
  - Ako vam treba hitan odgovor, samo stavite recÌŒ *HITNO* u subject i ja cÌu odgovoriti na takav mail cÌŒim ga dobijem.
  
---

## RacÌŒunarstvo visokih performansi

- U pitanju je prevodâ€”tehnicÌŒki kalkâ€”engleskog termina *High Performance Computing* cÌŒiju cÌu skracÌenicu (HPC) ja koristiti kao ime kursa u buducÌnosti.
- OpsÌŒte govorecÌi, videcÌete neobicÌŒno puno engleskih termina u ovim predavanjima.
- SÌŒto?
  - Nekad nema prevoda
  - Nekad prevod odudara zbog nasÌŒe nenaviknutosti
  - Uvek je neophodno znati engleski termin ako zÌŒelite da koristite Internet pretragu.

---

## Å ta je svrha predmeta?

- Uvod u programiranje, ali za super-racÌŒunare.
- Formalnije recÌŒeno, namena predmeta jeste da se steknu vesÌŒtine iz:
  - Arhitekture sistema visokih performansi.
  - Alata, biblioteka, i tehnologija za opsÌŒte visoko-paralelno programiranje.
  - Alata, biblioteka i tehnologija za domenski-specificÌŒno visoko-paralelno programiranje.
  - Alata, biblioteka, i tehnologija za merenje performansi algoritama.
  - Alata, biblioteka, i tehnologija za vizualizaciju velikih skupova podataka.
- Neformalnije recÌŒeno, namena predmeta jeste da se nateraju programi da idu *jako jako brzo*.

  
---

## Cilj i ishod

- Razumevanje arhitektura savremenih raÄunara visokih performansi i odgovarajuÄ‡ih modela izraÄunavanja. 
- Ovladavanje tehnikama programiranja nad arhitekturama visokih performansi i upoznavanje sa moguÄ‡nostima njihove praktiÄne primene u nauci i inÅ¾enjerstvu.
  
- Studenti stiÄu napredna znanja o modelima izraÄunavanja i arhitekturama raÄunara visokih performansi i ovladavaju odgovarajuÄ‡im tehnikama programiranja. 
- SteÄena znanja se koriste u praksi i struÄnim predmetima RaÄunarstvo visokih performansi u nauÄnim izraÄunavanjima i RaÄunarstvo visokih performansi u informacionom inÅ¾enjeringu.

---

## Da li ima udzÌŒbenik?

- Dokumentacija, ovi slajdovi, i belesÌŒke sa predavanja bi trebali da budu sasvim dovoljni.
- Predavanja su bazirana u velikoj meri na izvrsnoj knjizi "High Performance Computing: Modern System and Practices" cÌŒiji su autori T. Sterling, M. Anderson, i M. Brodowicz.
- TakoÄ‘e se preporucÌŒuje: "[Introduction to High Performance Scientific Computing](http://pages.tacc.utexas.edu/~eijkhout/Articles/EijkhoutIntroToHPC.pdf)" Victor Eijkhout koja je dostupna kroz CreativeCommons licencu.
- High Performance Computing: Modern Systems and Practices

---

## Da li je tesÌŒko?

- LosÌŒe vesti!
- *Niko nikada nije poloÅ¾io ovaj predmet u istoriji ÄoveÄanstva*.

---

## Ne, ozbiljno. Da li je tesÌŒko?

- Da. Ali ne nerazumno.
- Moj cilj jeste da vi ovo naucÌŒite bez suvisÌŒne muke. 
- NisÌŒta visÌŒe, nisÌŒta manje. Ako imate problem, javite sÌŒto ranije i oko svega se mozÌŒemo dogovoriti.

  
---

## BasÌŒ svega?

- ...ok, uhvatili ste me. Ne basÌŒ svega.
- Evo stvari koje nisu podlozÌŒne pregovorima na ovom kursu:
  - Morate da budete samostalni i posvecÌeni poslu.
  - Ne zbog mene, ovo su fundamentalni uslovi uspeha.
  - Prepisivanje se necÌe nikako, ikako, nikada tolerisati.
 


---

## Infrastruktura

- Deo toga Å¡to je predmet nov jeste to Å¡to se laboratorije joÅ¡ podeÅ¡avaju i Å¡to se infrastruktura predmeta joÅ¡ sreÄ‘uje.
- No, neke stvari su naravno poznate:
  - TrebaÄ‡e vam Linux, idealno Ubuntu 18.04, bilo direktno instaliran, bilo u virtuelnoj maÅ¡ini.
  - Dosta posla Ä‡e se raditi iz komandne linije.
  - NaÅ¡ primarni jezik je C/C++, mada Ä‡e biti i malo Python-a i R-a kasnije. 
  - Sav naÅ¡ alat Ä‡e biti Open Source.

---

## Linux?

- Da, Linux.
- Ispostavilo se, avaj, da nijedna godina nije godina Linux-a na desktop-u, ali kao uteÅ¡na nagrada, svaka godina je godina Linux-a u HPC primenama.
- Upotreba bilo Äega drugog nije ni opcija za nas.
- Ako vam rad sa Linux-om nije udoban, krajnje je vreme da se naviknete.
- Embrace the penguin.

---

## Komandna linija?

- Osim nekih oÄiglednih prednosti komandne linije, ima i vrlo praktiÄan razlog.
- Imamo HPC na raspolaganju i da bi ga kontrolisali sve Å¡to moÅ¾emo da uradimo jeste da se na njega prikaÄimo preko SSH protokola.
- Sve Å¡to SSH praktiÄno dozvoljava jeste komandna linija
- Ako znate za X Forwarding, svaka Äast, ali je suviÅ¡e nezgodno za nas.
- Generalno govoreÄ‡i, uvek radite sa komandnom linijom kada radite HPC.

  
---

## C/C++?

- Nemamo izbora.
- Ovo, baÅ¡ ovo, je mesto gde C i C++ briljiraju.
- Ima modernih jezika koji su interesantni: Go, pre svega, i Rust, ali za sada ovakav naÄin programiranja se radi blizu metalu.
- C/C++ je tehniÄki... pipav termin. Ono Å¡to ja ovde mislim jeste C i, gde moÅ¾emo, moderan C++.
- Budite sreÄ‡ni, mogli smo da koristimo FORTRAN.
---

## Python i R?

- BiÄ‡e malo ova dva jezika kada budemo priÄali o vizuelizaciji. 
- HPC rad je retko rad sam za sebeâ€”tipiÄno reÅ¡avamo nekakav problem.
- Stoga, heterogenost jezika je Äesta.
- Neretko postoji prototip u neÄemu udobnom kao Å¡to je Python, a vaÅ¡ posao je da uzmete to i uÄinite ga mnogo brÅ¾im
  
---
name: problemperformansi
layout: false
class: center, middle

# Problem performansi
### brzo o brzini i optimizaciji

---
layout: true

.section[[Problem performansi](#sadrzaj)]

---

## Å ta su performanse?

- Imamo dve moguÄ‡e definicije: 
  - Teoretske performanse.
  - PraktiÄne performanse.
- Teoretske performanse su apsolutni maksimum koji neki hardverski sistem moÅ¾e da izvuÄe i meri se u broju nekakvih operacija u sekundi. NajÄeÅ¡Ä‡e, jedinica je *FLOPS*â€”*FL*oating point *OP*eration per *S*econd.
- RaÄunari kakve vi, realistiÄno, imate imaju performanse koje se mere u desetinama gigaFLOPSa, ne raÄunajuÄ‡i GPU.
- NajbrÅ¾i raÄunar? 
  - IBM Summit. 200 *petaflops*. 
  - ÄŒudo Å¡ta 13MW moÅ¾e da uradi.


---

## Å ta su performanse?

- To je lepo, ali nama ne treba racÌŒunar da trosÌŒi struju i zvucÌŒi impresivno.
- Nama treba resÌŒenje, i to dovodi do prakticÌŒnih performansi.
- PrakticÌŒne performanse su, efektivno, koliko vremena treba da se doÄ‘e do resÌŒenja.
- Mnogo su realisticÌŒnije (posÌŒto nas basÌŒ to zanima) ali dobiti ih je jako jako tesÌŒko.
- TipicÌŒno se procenjuju na osnovu kalibracionog programaâ€” Benchmark-a.


---

## Kako programer zamisÌŒlja racÌŒunar ?

- Moj program ima nekakve podatke i sam kod.
- I jedno i drugo zÌŒivi u memoriji.
- Kod se sastoji od atomskih operacija, instrukcija koje traju neku jedinicu vremena ti.
- Procesor izvrsÌŒava moje instrukcije, jednu po jednu.
- Ako hocÌu brzÌŒi program, opcije su mi:
  - Manje instrukcija. 
  - KracÌe vreme izvrsavanja.


---

## Oh, sweet child of summer...

- ...svi vi, znate nadam se da ovo nije tacÌŒno.
- Ali mozÌŒda ne znate koliko nije tacÌŒno.
- Ipak, iako nije tacÌŒno ovo nije potpuno beskorisno.
- Minimizacija broja instrukcija je, generalno govorecÌi, dobar nacÌŒin da se program ubrza.
- MozÌŒete misliti o ovome kao o kontroli vremenske kompleksnosti algoritma.
- Da li ste vi ovo radili?
- To je dobra ideja, ali ne svrha ovog kursa.

---

## Dobro, sÌŒta ne valja sa ovom priÄom?

- VaÅ¡ procesor ima u sebi, efektivno, viÅ¡e procesora.
- Ali svaki od tih procesora izvrÅ¡ava viÅ¡e stvari istovremeno.
- TakoÄ‘e, ta istovremenost je kompleksna zahvaljujuÄ‡i pipelining-u.
- TakoÄ‘e takoÄ‘e, mehanizmi u raÄunaru operiÅ¡u na kompletno razliÄitim vremenskim skalama.
- TakoÄ‘e takoÄ‘e...
     


---

## Ovo je komplikovanije nego sÌŒto izgleda.

- RaÄunar se jako trudi da vam predstavi sliku da je samo instancirana Fon Nojmanova arhitektura i da je memorija lako i proizvoljno adresabilna.
- LakÅ¡e je tako programirati i veÄ‡inu vremena Å¾elite tu iluziju, ali ne i kada hoÄ‡ete da iscedite svaki poslednji dram performansi iz sistema.
 

---

## Block diagram of the Intel Sandy Bridge core

.lcol[

![](img/intel.png)

]

.rcol[

<br><br><br>
 - Ovo je komplikovanije nego sÌŒto izgleda.

]


---

## Å ta su glavne komplikacije na jednom racÌŒunaru?

- Ne zaboravite, ovde josÌŒ pricÌŒamo o prostom racÌŒunaru koji vam stoji na radnom stolu.
- Prvo, ima visÌŒe jezgara.
- Drugo, instrukcije mogu da traju razlicÌŒiti broj ciklusa.
- Dalje ima paralelizam na nivou instrukcija (eng. Instruction Level Paralelism)
- Memorija ima striktnu hijerarhiju


---

## ILP

- Nezavisne instrukcije mogu da krenu da se izvrsÌŒavaju u isto vreme, koristecÌi paralelne strukture u samom silikonu.
- ZahvaljujucÌi sekvenci izvrsÌŒavanja, visÌŒe funkcija mozÌŒe da ide jedno za drugim u protocÌŒnom rezÌŒimu (eng. "pipelining")
- Da ne bi bilo praznog hoda, procesor izvrsÌŒava grane u vasÌŒem kodu pre nego sÌŒto se zna u koju cÌe se ucÌi. Ako je pogodio kako treba, odlicÌŒno, ako ne rezultat se baca i program se vracÌa u prethodno stanje.
- Da bi pipelining radio sÌŒto bolje, instrukcije za koje je to mogucÌe cÌe biti izvrsÌŒene u najoptimalnijem redosledu ne vasÌŒem redosledu.
- Podaci se dostavljaju iz nivoa memorije u nivo memorije spekulativno, tj. ako se misli da cÌe mozÌŒda trebati.

---

## Pipeline

.lcol[

![](img/pipeline.jpg)

]

.rcol.medium[

- Princip pipeline-a uvodi paralelizam na nivou instrukcija
- Operacije izvrsavaju paralelno ili konkurentno.
- Broj stepena na koji se razlaze instrukcija moze da bude nekoliko desetina. 
- Vreme potrebno da instrukcija prodje ceo pipeline zove se latentno vreme. 
- Latentno vreme se povecava za *X* pipelinea zbog uvodjenja dodatnih hardverskih komponenti za svaki stepen. 
- Brzina obrade je povecana usloznjavanjem procesora na hardverskom nivou.

]


---

## Pipeline ubrzanje

.lcol[

- n â€” broj proruacÌŒna koje hocÌemo
- l â€” broj koraka u procesnom toku
- Ï„ â€” vreme za jedan ciklus sistemskog sata
- t(n) â€” vreme za n operacija
- s â€” vreme neophodno da se namesti da pipelining radi

]

.rcol[

- Brzina serijskog izvrsÌŒavanja 
  - ğ‘¡(ğ‘›) =ğ‘›ğ‘™ğœ
- Brzina ILP izvrsÌŒavanja
  - ğ‘¡(ğ‘›) = [ğ‘ +ğ‘™+ğ‘›âˆ’1]ğœ
]

---

## Hijerarhija memorije

.center-table.medium[

|   Tip memorije  | Red velicÌŒine |       Brzina ucÌŒitavanja       |
|:---------------:|:------------:|:-----------------------------:|
|     Registar    |  128 bajtova |       Koliko i procesor       |
|      L1 KesÌŒ     |    ~16 KB    |         Pola procesora        |
|      L2 KesÌŒ     |    ~256 KB   |     Oko sÌŒestina procesora     |
|      L3 KesÌŒ     |     ~8MB     |      Oko 12-ina procesora     |
| Glavna memorija |     ~16GB    | 100 ciklusa sa oko 5% protoka |
|     SSD disk    |    ~512GB    |           Jako dugo           |
|     HDD disk    |     ~2TB     |            VecÌŒnost            |

]

---

## KeÅ¡

- Nikad nema dovoljno.
- Ko se secÌa Celerona, Durona, i sl.?
- U praksi, automatski mehanizmi pokusÌŒavaju da u kesÌŒu drzÌŒe podatke koje nama trebaju.
- Ako, kada program zatrazÌŒi podatak, on stoji u kesÌŒu odliÄno. Imamo ubrzanje.
- Ako ne, imamo omasÌŒaj, ond. `cache miss`.

---

## Katalog omasÌŒaja

- NeizbezÌŒan
  - Kada prvi put trazÌŒimo podatke.
- Kapacitetski
  - Kada nema visÌŒe mesta.
- Konflikt
  - Kada mapiramo (kesÌŒ menja memoriju, tj. lokacije u kesÌŒu su ubrzane memorijske lokacije sa tacÌŒke gledisÌŒta adresiranja), mapirali smo dve stvari na isto mesto.
- Invalidacija
  - VisÌŒe jezgara se posvaÄ‘alo oko toga sÌŒta je najsvezÌŒija verzija nekog podatka.
  
---

## KesÌŒ blok

- Instrukcije ne mogu da direktno adresiraju kesÌŒ
- I dalje misle da pricÌŒaju sa glavnom memorijom
- Ovo je cÌŒesta apstrakcija odgovorna i za, npr. memory-mapped I/O
- Iza kulisa, mikrokontroler procesora uzima podatke iz memorije i smesÌŒta ih u kesÌŒ u jedinicama fiksne velicÌŒine (blokovima).
- TipicÌŒno, 128 bajtova. To znacÌŒi da dobijamo ceo taj komad memorije hteli mi to ili ne.
- Zatim se belezÌŒi koji deo memorije je mapiran na koji deo kesÌŒa i, kada ponestane prostora, menja se najdavnije korisÌŒcÌeni deo. LRU
  - Ovo je lazÌŒ. VisÌŒe o tome kasnije.

---

## Koja je prakticÌŒna primena znanja o kesÌŒ blokovima?

- Pakovanje podataka.
- Ako prolazimo kroz niz element po element, kada ucÌŒitamo prvi element, uz njega dolazi N sledecÌih dzÌŒabe.
- Ako procesiramo svaki element, onda to je to.
- Ali sÌŒta ako je ovo niz tacÌŒaka u 3D prostoru a nas samo zanima X vrednost.
- Imamo jako puno bacÌŒenih ucÌŒitavanja.
- Ako znamo kako cÌe neki podaci biti procesirani, isplati se da se upakuju tako da podaci koji se zajedno koriste budu blizu.

---

## Array stride

- Recimo da hocÌemo da saberemo dva niza kompleksnih brojeva.
- To znacÌŒi (ako koristimo double preciznost) da nam treba 16 bajtova po broju.
- KesÌŒ linija je, recimo, 128.
- To znacÌŒi da bi trebalo da je brzÌŒe da se brojevi sa sabiranje prepletu u jedan niz.
  - Re(A0) 
  - Im(A0)
  - Re(B0)
  - Im(B0)
  - Re(A1)
  - ...
  

---

## Address alignment

- Lukaviji mozÌŒda mogu da primete da ja mogu da adresiram bilo koju adresu u glavnoj memoriji na bajt nivou, cÌŒak i ako radim na nivou recÌŒi.
- Da li to znacÌŒi da nekako, magicÌŒno, ima poravnanje izmeÄ‘u kesÌŒa i memorije?
- Ne. Multi-bajt vrednost mozÌŒe vrlo lako da bude u dva kesÌŒ bloka.
- Ovo je spektakularno losÌŒe po performanse.
- Ponekad, kompajler je dovoljno pametan da to otkloni.
- A ako nije?

---

## Do try this at home...

```c
#include <stdio.h>
#include <stdlib.h>

int main(){
    double* a;
    a = malloc(1024*8 +8); // niz 1024 double vrednosti
    printf("%p\n", a);
    if((size_t)a %8 != 0){ // detektovano neporavnanje
        a = (double*)((((size_t)a >>3) << 3));
    }
    printf("%p\n", a);
    free(a);
}

```


---

## Rezultat eksperimenta

```sh

[Running] cd /hpc/ && gcc test.c -o test && /hpc/test
0x7fca44001000
0x7fca44001000

[Done] exited with code=0 in 0.21 seconds

```
- Na mom GCC, ovo je beskorisno. 
- VecÌ dobijam poravnanu memoriju.
- Mnogo zavisi od kompajlera, i cÌŒesto morate kod da tetosÌŒite predprocesorskim direktivama da dobijete ono sÌŒto zÌŒelite.
 

---

## Malo sam lagao o kesÌŒu...

- Rekao sam ranije da se belezÌŒi region memorije i lokacija u kesÌŒu
- To... basÌŒ i nije tacÌŒno.
- To bi zahtevalo tkzv. asocijativan kesÌŒ. Ovi su spori.
- Ono sÌŒto se koristi u praksi je k-struki asocijativan kesÌŒ.
- To znacÌŒi da postoji transformaciona funkcija koja mapira lokaciju u memorji na lokaciju u kesÌŒu na visÌŒe mogucÌih nacÌŒina. 
  - TipicÌŒno od 2 do 8.
- Onda, u slucÌŒaju konflikta u mapiranju, koristi se jedna od dodatnih lokacija osloboÄ‘ena po LRU principu.

---

## Å ta je sve ovo trebalo da me nauÄi?

- Osim malo o arhitekturi racÌŒunara ima josÌŒ i ovo:
- Kako se nesÌŒto implementira interaguje jako komplikovano sa hardverom procesora i racÌŒunara uopsÌŒte da proizvede performanse.
- Stoga, programiranje performantnog koda mozÌŒe biti jako izazovno.
- A sve ovo je na samo jednom racÌŒunaru...

  
---
name: hpcuvod
layout: false
class: center, middle

# HPC uvod
### Å¡ta kada procesor jednostavno nije dovoljno brz

---
layout: true

.section[[HPC uvod](#sadrzaj)]

---

## Paralelizam

- Prethodna sekcija je pokazala da su performanse tesÌŒke, ali je sva bila opsednuta time da se iz jednog procesora izvucÌŒe maksimum.
- BuducÌi da se nasÌŒ kod, na kraju dana, izvrsÌŒava na nekom procesoru, negde, to nije losÌŒa ideja i uvek cÌe biti relevantno, ali sÌŒta kada 100% nekog procesora nije dovoljno brzo?
- Postoje prakticÌŒne granice gigahercazÌŒi koju mozÌŒemo da dobijemo iz cÌŒipa
  - Bakar
  - Brzina svetlosti
  
---

## Paralelizam

- Zbog ovoga superracÌŒunari danas nisu (i verovatno nikad visÌŒe necÌe biti) jedan jako mocÌan procesor.
- Ono sÌŒto cÌŒini superracÌŒunar super jeste broj procesorskih elemenata.
- Da bi se broj procesorskih elemenata iskoristio kako treba, potrebno je pisati kod koji je paralelan, tj. izvrsÌŒava visÌŒe stvari istovremeno.
- Ovo nije paralelizam na nivou instrukcije, koliko je paralelizam na nivou algoritma.
- Priroda algoritma dramaticÌŒno uticÌŒe na to koliko je lako odn. tesÌŒko izvrsÌŒiti paralelizaciju.

---

## Å ta je nasÌŒ posao?

- Da dobijemo odgovor jako jako brzo.
- Da, ali kako?
- Napadamo problem sa dve strane:
  - Arhitektura
  - Algoritam
- Dakle, treba da napravimo masÌŒinu koja ima jako efektan dijapazon procesora koji brzo komuniciraju i imaju sÌŒta im treba da ostvare blizu svom teoretskom maksimumu.
- Sa druge strane treba da upravljamo tom masÌŒinom i podelimo algoritme na takav nacÌŒin da se adekvatni delovi algoritma izvrsÌŒavaju na pravom mestu radi brzine.


---

## Anatomija jednog superraÄunara

- SuperracÌŒunar tipicÌŒno ima neki broj cÌŒvorova.
- CÌŒvor se mozÌŒe zamisliti kao jedan racÌŒunar.
- IBM Summit, ima specificÌŒno 4608 raÄunara/Ävora.
- Svaki cÌŒvor je jako mocÌan i sadrzÌŒi visÌŒe procesora (2) sa visÌŒe jezgara (21) gde svako jezgro podrzÌŒava 4 nezavisna izvrsÌŒavanja i visÌŒe izuzetno mocÌnih GPU-ova (6).
- TakoÄ‘e ima oko 1600GB memorije po cÌŒvoru.


---

## Jedno jezgro

![:scale 70%](img/IBMSummit.png)


---

## Mnogo paralelizama

- Ovde ima jako puno stvari koje podrzÌŒavaju paralelizam
- Izazov jeste napraviti kod koji ima odgovarajucÌi posao za svaki paralelizam koji hardver nudi
- Neke stvari su taman za rad na jednom jezgru ili jednom procesoru
- A neki poslovi se najbolje dele izmeÄ‘u individualnih cÌŒvorova gde je komunikacija izmeÄ‘u njih izuzetno retka.
- RazlicÌŒite tehnologije su dobre za razlicÌŒite nivoe paralelizma. Gledano iz pticÌŒije perspektive

---

## Mnogo paralelizama

.center-table[

| Harverski nivo paralelizma |   Tehnologija   |
|:--------------------------:|:---------------:|
|   Unutar jednog procesora  | OpenMP/pThreads |
|       IzmeÄ‘u cÌŒvorova       |     OpenMPI     |
|      Na GPU ureÄ‘ajima      |     OpenACC     |

]

---

## Skaliranje

- Skaliranje je kako ukupne ostvarne performanse zavise od velicÌŒine sistema.
- Tj. ako povecÌamo racÌŒunar dva puta koliko dodatnih performansi dobijemo od toga?
- Idealno dva, da, ali...
- Skaliranje ima dva tipa
  - Slabo
      - Uniformni rast velicÌŒine sistema, memorije i problema.
  - Jako
      - VelicÌŒina problema ostaje ista, skalira se velicÌŒina sistema za povecÌanje brzine.

---

## Å ta smeta skaliranju?

.medium[
- Koristi se mnemonik SLOW za faktore koji sprecÌŒavaju da sistem dostigne svoj teoretski maksimum. 
- SLOW su:
  - Starvation
      - Nema dovoljno posla da se uposle svi resursi sistema.
      - MozÌŒda sistem mozÌŒe da radi 600 svari istovremeno, ali ako trenutno postoji samo 6 nezavisnih zadataka, sistem radi na 1% svojih performansi.
  - Latency
      - Sistem mozÌŒe da bude veliki, i ako informacija sa jednog kraja sistema bude neophodna na drugom, cÌŒekanje na nju proizvodi znacÌŒajno usporenje. Setite se dijagram od ranije i razlicÌŒitih protoka podataka.
  - Overhead
      - Sav taj kod koji deli podatke i vodi racÌŒuna ko radi kada sÌŒta i integrisÌŒe rezultate itd. itd. itd. oduzima neko vreme i neke resurse da se izvrsÌŒi.
  - Waiting
      - ÄŒim ima visÌŒe niti izvrsÌŒavanja mozÌŒe docÌi do problema nadmetanja ("contention") oko deljenih resursa. Ovo se resÌŒava cÌŒekanjem. In a stunning turn of events, waiting turns out to be bad for performance. Who knew?
]


---
name: kratkaistorija
layout: false
class: center, middle

# Kratka istorija

---
layout: true

.section[[Kratka istorija](#sadrzaj)]

---

## MehaniÄko raÄunanje

- ZÌŒelja za masÌŒinom koja racÌŒuna umesto nas, ili barem proces cÌŒini laksÌŒim je verovatno samo par minuta mlaÄ‘a od samog koncepta racÌŒunanja.
- Rano racÌŒunanje je, u stvari, bilo samo po sebi fundamentalno vezano za nekakvo pomocÌno ustrojstvo.
- Drevni Rimljani su imali brojeve koji su bili prilicÌŒno tesÌŒki za mehanicÌŒku manipulaciju
- Mislim, koliko je LXVII puta XI? A da ne prebacite prvo u arapske brojeve?
- Rimljani su imali metod koji je ukljucÌŒivao pazÌŒljivo napravljenu tablicu i kamencÌŒicÌe.
- Deminutivska mnozÌŒina recÌŒi za â€™kamenâ€™ na latinskom je â€™calculiâ€™
- Odatle kalkulator, kalkulisanje, itd. itd.

---

## MehaniÄko raÄunanje

- Ovo je nastalo, toliko da su ljudi koji su radili sa novcem (te mnogo raÄunali) u kasnosrednjevekovnoj Italiji uvek imali pri ruci klupu sa ucrtanom sÌŒemom za racÌŒun.
- Termin za klupa je bio â€™bancaâ€™
- Kasnije su presÌŒli na novi, divni metod za racÌŒunanje koji ne zahteva klupu no upotrebljava cÌŒudne strane cifre. Taj metod su zvali po iskvarenom imenu kreatora â€™algorisamâ€™
- MusÌŒterije nisu verovale ovakom algorismicÌŒnom bankarstvu i hteli su klupe nazad. NarocÌŒito omrznuta je bio potpuno novi simbolâ€”nula. Toliko je bila omrznuta da je arapsko ime za njuâ€”al sifrâ€”usÌŒlo u skoro sve evropske jezike.
- Kao â€™sÌŒifra.â€™

---

## MehaniÄko raÄunanje

- Ne mozÌŒemo, ocÌŒigledno da se oslobodimo mehanicÌŒkih racÌŒunala.
- Prva mehanicÌŒka racÌŒunala su bila fundamentalno samo racÌŒunaljke.
 
---

## Analogni raÄunar

- Mislite o tome kao o kompleksnoj fizicÌŒkoj inkarnaciji matematicÌŒke funkcije
- MozÌŒemo da menjamo parametre, ali priroda funkcije je ista
- Jeste racÌŒunar ali nije programabilan.

---

## Prvi pravi raÄunar

- ...ali samo na papiru.
- Memorija, programi, opsÌŒta namena.
- Nikada nije napravljen, ali moderne studije ukazuju da je mogao biti uz ogromnu investiciju.

---

## Da se uozbiljimo

- Å ta je sa istorijom elektronskih super-racÌŒunara?
- Tradicionalno, deli se u â€™epoheâ€™ koje karakterisÌŒe dominacija odreÄ‘enih tehnologija.

---

## Epoha Iâ€”elektromehanicÌŒka era

.lcol.medium[

- Zuse Z1 (1938)
- Harvard Mk1(1944)

- Brzine od cÌŒak jedne instrukcije u sekundi!
- BusÌŒene kartice za I/O
- JosÌŒ nema programskih jezika kao takvih
- CÌŒercÌŒ i Tjuring postavljaju teoretske osnove racÌŒunara

]

.rcol[

![:scale 70%](img/e1.png)

]

---
## Epoha IIâ€”Fon Nojmanova Arhitektura i Vakumske cevi

.lcol[

- ENIAC
- EDSAC (1949)
- Colossus
- IBM 704
- UNIVAC (1951)

]

.rcol[

![:scale 70%](img/e2.png)

]

---

## Epoha IIâ€”Fon Nojmanova Arhitektura i Vakumske cevi

- Vrhunske masÌŒine ere postizÌŒu do 10 KIPS
- 4KB memorije
- U ranom dobu koriste se zÌŒivina kola za memoriju
- Kasnije magnetna jezgra
  - Ovo je ostavilo traga do danasâ€”ako vam je ikada pukao program u Linux-u i ostavio `core dump`, sada znate odakle ime.
- U ovom periodu:
  - Fon Nojman postavlja osnove moderne arhitekture racÌŒunara.
  - Klod SÌŒanon postavlja osnove informatike.

---

## Epoha IIIâ€”Paralelizam na nivou instrukcije i uspon tranzistora

.lcol.medium[

- Era pocÌŒinje sa TX-0 racÌŒunarom i vodi preko DEC PDP-1 i IBM 7090 do vrhunca trecÌe epohe
- CDC 6600 (1965)

- CDC6600 je imao ïµ 1 MFLOPS!
  - 10 MHz takt!
  - 10 logicÌŒkih jedinica!
  - Prvi ILP!
  - Jedan od prvih ureÄ‘aja koji se zvao â€superkompjuterâ€œ

]

.rcol[

![:scale 70%](img/e3.png)

]

---

## Epoha IVâ€”Vektorski procesori i integrisana kola

.lcol.medium[

- RacÌŒunar koji je obelezÌŒio ovu epohu je legendarni Krej-1 (1976)
- KarakterisÌŒe ga izuzetno dugacÌŒak pipeline.

- Krej-1 je mogao:
  - 80 MHz!
  - 160 MFLOPS!
  - 8.39MB memorije!
  - 303MB diska!

]

.rcol[

![:scale 70%](img/e4.png)

]

---

## Epoha Vâ€”SIMD i spor uspon mikroprocesora

- SIMD je jedna od fundamentalnih HPC arhitektura po Flinovoj taksonomiji (vidi kasnije)
- Podelimo podatke na blokove, a onda radimo istu stvar svakom bloku podataka.
- SIMD â€” Single Instruction Multiple Data
- Problem sa SIMD-om jeste sÌŒto su algoritmi bili fantasticÌŒni za neke stvari i potpuno beskorisni za sve ostalo.
- SIMD (kasnije, kasnije) i dalje zÌŒiviâ€”postoji nacÌŒin na koji je svaki GPU u stvari sÌŒiroka SIMD implementacija.
- NEC SX-2
  - Prvi racÌŒunar da probije GFLOPS barijeru

---

## Epoha VIâ€”Mnogo Procesora

- Touchstone Paragon (1994)
- IBM SP-2
- Thinking Machines Corporation CM-5 (1992)
- Prvi moderni superkompjuteri
- ProsleÄ‘ivanje poruka i odvojena memorija, po prvi put.
- TakoÄ‘e, prvi put se pojavio potrosÌŒacÌŒki klaster (commodity cluster)
  - UC Berkley NOW
  - Beowulf
      - PC + Linux + Ethernet + MPI = Supercomputing For Everyone

---

## Epoha VII?

- Mi smo ovde.
- I dalje su dominantne tehnologije iz sÌŒeste epohe ali uz dodatak ekstremne heterogenosti.
- U jednom cÌŒvoru imamo i SIMD i shared-memory i message-passing.
- Moglo bi se recÌi da ovo predstavlja odrastanje HPCa.
---

## Dalje?

- Masivne online mrezÌŒe.
- 3D cÌŒipovi i sinteticÌŒki dijamant
- Neuroprocesori i domain specific arhitekture
- Kvantni racÌŒunari





    </textarea>
    <script src="../remark-latest.min.js"></script>
    <script>
        // https://github.com/gnab/remark/issues/72
        remark.macros.scale = function (percentage) {
            var url = this;
            return '<div class="center"><img src="'
                 + url + '" style="width: ' + percentage + '" /></div>';
        };
        var slideshow = remark.create({
                    highlightLanguage: 'python',
                    // highlightStyle: 'obsidian',
                    highlightStyle: 'github',
                    highlightLines: true
                });
    </script>
    
  </body>
</html>
